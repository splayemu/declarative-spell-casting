<!DOCTYPE html>
<html>
	<head>	
		<title>Declarative Spell Casting</title>

		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
		<!--<script type="text/javascript" src="http://cdn.craftycomponents.com/crafty-release.js"></script>-->
		<script type="text/javascript" src="crafty.js"></script>
		<script type="text/javascript" src="interpreter.js"></script>
		<script type="text/javascript" src="game.js"></script>
		<script type="text/javascript" src="spells.js"></script>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script type="text/javascript">
			jQuery(document).ready(function(){
				list_spell_names();
				
				
				$("#submit_btn").click(function() {  
					var spell_name 		= $("input#spell_name").val();
					var spell_text 		= $("textarea#spell_text").val();
					var spell_params 	= $("textarea#spell_params").val();
					//alert("Spell text: " + spell_text);
					insert_player_spell(spell_name, spell_params, spell_text);
					list_spell_names();
					return false; 
				});  
				
				$(".spell_name").live('click', (function() {  
					var clicked_spell_name = $(this).text();
					grab_spell_text(clicked_spell_name);
					grab_spell_params(clicked_spell_name);
					//alert(clicked_element);
					return false; 
				}));
			});
/*
			// used for when the user clicks on the add spell button
			$(function() {  
				$("#submit_btn").click(function() {  
					var spell_name = $("input#spell_name").val();
					var spell_text = $("textarea#spell_text").val();
					//alert("Spell text: " + spell_text);
					insert_player_spell(spell_name, {}, spell_text);
					list_spell_names();
					return false; 
				});  
			}); 
			
			// when the user clicks on a spell name they have already created
			$(function() {  
				$(".spell_name").live('click', (function() {  
					var clicked_spell_name = $(this).text();
					grab_spell_text(clicked_spell_name);
					grab_spell_params(clicked_spell_name);
					//alert(clicked_element);
					return false; 
				}));
			}); */
 
			var list_spell_names = function () {
				$("#spell_name_lister").html('');
				for(var spell_name in player_spells) {
					//log("Spell name: " + spell_name);
					$("#spell_name_lister").append('<div id=spell_' + spell_name + ' class=spell_name>' + spell_name + '</div>');
				}
			}
			var grab_spell_text = function (spell_name) {
				// save code currently in textarea#spell_text
				var spell = player_spells[spell_name];
				if(spell == undefined) {
					alert("Error: " + spell_name + " is not a spell");
					return false;
				}
				var spell_text = spell['spell_text'];
				$("textarea#spell_text").val(spell_text);
			}
			
			var grab_spell_params = function (spell_name) {
				// save code currently in textarea#spell_text
				var spell = player_spells[spell_name];
				if(spell == undefined) {
					alert("Error: " + spell_name + " is not a spell");
					return false;
				}
				var spell_params = spell['params'];
				$("textarea#spell_params").val(spell_params);
			}
 
		</script>
	</head>
	<body>
		<h1>Declarative Spell Casting</h1>
		<div id="main_horizontal_column">
			<div id="main_game_box">
				<div id="game_location">
					<div id="cr-stage"></div>
				</div>
			</div>
			<div id="spell_library_box">
				<div id="spell_name_area">
					<div id="spell_name_centered_area">
						<div id="spell_name_lister"> </div>
						<div id="new_spell_name">
							<input type="text" id="spell_name" name="spell_name" />
							<input type="submit" name="submit" class="button" id="submit_btn" value="Add Spell" />
						</div>
					</div>
				</div>
				<div id="spell_display_area">
					<div id="params_display_area">
						<textarea id="spell_params"/>Enter Spell Parameters Here</textarea>
					</div>
					<div id="spell_display_centered_area">
						<textarea id="spell_text"/>Enter Spell Text Here</textarea>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
